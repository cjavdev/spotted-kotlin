// File generated from our OpenAPI spec by Stainless.

package com.spotted.api.models.audioanalysis

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.spotted.api.core.jsonMapper
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class AudioAnalysisRetrieveResponseTest {

    @Test
    fun create() {
        val audioAnalysisRetrieveResponse =
            AudioAnalysisRetrieveResponse.builder()
                .addBar(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .addBeat(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .meta(
                    AudioAnalysisRetrieveResponse.Meta.builder()
                        .analysisTime(6.93906)
                        .analyzerVersion("4.0.0")
                        .detailedStatus("OK")
                        .inputProcess("libvorbisfile L+R 44100->22050")
                        .platform("Linux")
                        .statusCode(0L)
                        .timestamp(1495193577L)
                        .build()
                )
                .addSection(
                    AudioAnalysisRetrieveResponse.Section.builder()
                        .confidence(1.0)
                        .duration(6.97092)
                        .key(9L)
                        .keyConfidence(0.297)
                        .loudness(-14.938)
                        .mode(AudioAnalysisRetrieveResponse.Section.Mode.minus_1)
                        .modeConfidence(0.471)
                        .start(0.0)
                        .tempo(113.178)
                        .tempoConfidence(0.647)
                        .timeSignature(4L)
                        .timeSignatureConfidence(1.0)
                        .build()
                )
                .addSegment(
                    AudioAnalysisRetrieveResponse.Segment.builder()
                        .confidence(0.435)
                        .duration(0.19891)
                        .loudnessEnd(0.0)
                        .loudnessMax(-14.25)
                        .loudnessMaxTime(0.07305)
                        .loudnessStart(-23.053)
                        .pitches(listOf(0.212, 0.141, 0.294))
                        .start(0.70154)
                        .timbre(listOf(42.115, 64.373, -0.233))
                        .build()
                )
                .addTatum(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .track(
                    AudioAnalysisRetrieveResponse.Track.builder()
                        .analysisChannels(1L)
                        .analysisSampleRate(22050L)
                        .codeVersion(3.15)
                        .codestring("codestring")
                        .duration(207.95985)
                        .echoprintVersion(4.15)
                        .echoprintstring("echoprintstring")
                        .endOfFadeIn(0.0)
                        .key(9L)
                        .keyConfidence(0.408)
                        .loudness(-5.883f)
                        .mode(0L)
                        .modeConfidence(0.485)
                        .numSamples(4585515L)
                        .offsetSeconds(0L)
                        .rhythmVersion(1.0)
                        .rhythmstring("rhythmstring")
                        .sampleMd5("sample_md5")
                        .startOfFadeOut(201.13705)
                        .synchVersion(1.0)
                        .synchstring("synchstring")
                        .tempo(118.211f)
                        .tempoConfidence(0.73)
                        .timeSignature(4L)
                        .timeSignatureConfidence(0.994)
                        .windowSeconds(0L)
                        .build()
                )
                .build()

        assertThat(audioAnalysisRetrieveResponse.bars())
            .containsExactly(
                TimeIntervalObject.builder()
                    .confidence(0.925)
                    .duration(2.18749)
                    .start(0.49567)
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.beats())
            .containsExactly(
                TimeIntervalObject.builder()
                    .confidence(0.925)
                    .duration(2.18749)
                    .start(0.49567)
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.meta())
            .isEqualTo(
                AudioAnalysisRetrieveResponse.Meta.builder()
                    .analysisTime(6.93906)
                    .analyzerVersion("4.0.0")
                    .detailedStatus("OK")
                    .inputProcess("libvorbisfile L+R 44100->22050")
                    .platform("Linux")
                    .statusCode(0L)
                    .timestamp(1495193577L)
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.sections())
            .containsExactly(
                AudioAnalysisRetrieveResponse.Section.builder()
                    .confidence(1.0)
                    .duration(6.97092)
                    .key(9L)
                    .keyConfidence(0.297)
                    .loudness(-14.938)
                    .mode(AudioAnalysisRetrieveResponse.Section.Mode.minus_1)
                    .modeConfidence(0.471)
                    .start(0.0)
                    .tempo(113.178)
                    .tempoConfidence(0.647)
                    .timeSignature(4L)
                    .timeSignatureConfidence(1.0)
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.segments())
            .containsExactly(
                AudioAnalysisRetrieveResponse.Segment.builder()
                    .confidence(0.435)
                    .duration(0.19891)
                    .loudnessEnd(0.0)
                    .loudnessMax(-14.25)
                    .loudnessMaxTime(0.07305)
                    .loudnessStart(-23.053)
                    .pitches(listOf(0.212, 0.141, 0.294))
                    .start(0.70154)
                    .timbre(listOf(42.115, 64.373, -0.233))
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.tatums())
            .containsExactly(
                TimeIntervalObject.builder()
                    .confidence(0.925)
                    .duration(2.18749)
                    .start(0.49567)
                    .build()
            )
        assertThat(audioAnalysisRetrieveResponse.track())
            .isEqualTo(
                AudioAnalysisRetrieveResponse.Track.builder()
                    .analysisChannels(1L)
                    .analysisSampleRate(22050L)
                    .codeVersion(3.15)
                    .codestring("codestring")
                    .duration(207.95985)
                    .echoprintVersion(4.15)
                    .echoprintstring("echoprintstring")
                    .endOfFadeIn(0.0)
                    .key(9L)
                    .keyConfidence(0.408)
                    .loudness(-5.883f)
                    .mode(0L)
                    .modeConfidence(0.485)
                    .numSamples(4585515L)
                    .offsetSeconds(0L)
                    .rhythmVersion(1.0)
                    .rhythmstring("rhythmstring")
                    .sampleMd5("sample_md5")
                    .startOfFadeOut(201.13705)
                    .synchVersion(1.0)
                    .synchstring("synchstring")
                    .tempo(118.211f)
                    .tempoConfidence(0.73)
                    .timeSignature(4L)
                    .timeSignatureConfidence(0.994)
                    .windowSeconds(0L)
                    .build()
            )
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val audioAnalysisRetrieveResponse =
            AudioAnalysisRetrieveResponse.builder()
                .addBar(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .addBeat(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .meta(
                    AudioAnalysisRetrieveResponse.Meta.builder()
                        .analysisTime(6.93906)
                        .analyzerVersion("4.0.0")
                        .detailedStatus("OK")
                        .inputProcess("libvorbisfile L+R 44100->22050")
                        .platform("Linux")
                        .statusCode(0L)
                        .timestamp(1495193577L)
                        .build()
                )
                .addSection(
                    AudioAnalysisRetrieveResponse.Section.builder()
                        .confidence(1.0)
                        .duration(6.97092)
                        .key(9L)
                        .keyConfidence(0.297)
                        .loudness(-14.938)
                        .mode(AudioAnalysisRetrieveResponse.Section.Mode.minus_1)
                        .modeConfidence(0.471)
                        .start(0.0)
                        .tempo(113.178)
                        .tempoConfidence(0.647)
                        .timeSignature(4L)
                        .timeSignatureConfidence(1.0)
                        .build()
                )
                .addSegment(
                    AudioAnalysisRetrieveResponse.Segment.builder()
                        .confidence(0.435)
                        .duration(0.19891)
                        .loudnessEnd(0.0)
                        .loudnessMax(-14.25)
                        .loudnessMaxTime(0.07305)
                        .loudnessStart(-23.053)
                        .pitches(listOf(0.212, 0.141, 0.294))
                        .start(0.70154)
                        .timbre(listOf(42.115, 64.373, -0.233))
                        .build()
                )
                .addTatum(
                    TimeIntervalObject.builder()
                        .confidence(0.925)
                        .duration(2.18749)
                        .start(0.49567)
                        .build()
                )
                .track(
                    AudioAnalysisRetrieveResponse.Track.builder()
                        .analysisChannels(1L)
                        .analysisSampleRate(22050L)
                        .codeVersion(3.15)
                        .codestring("codestring")
                        .duration(207.95985)
                        .echoprintVersion(4.15)
                        .echoprintstring("echoprintstring")
                        .endOfFadeIn(0.0)
                        .key(9L)
                        .keyConfidence(0.408)
                        .loudness(-5.883f)
                        .mode(0L)
                        .modeConfidence(0.485)
                        .numSamples(4585515L)
                        .offsetSeconds(0L)
                        .rhythmVersion(1.0)
                        .rhythmstring("rhythmstring")
                        .sampleMd5("sample_md5")
                        .startOfFadeOut(201.13705)
                        .synchVersion(1.0)
                        .synchstring("synchstring")
                        .tempo(118.211f)
                        .tempoConfidence(0.73)
                        .timeSignature(4L)
                        .timeSignatureConfidence(0.994)
                        .windowSeconds(0L)
                        .build()
                )
                .build()

        val roundtrippedAudioAnalysisRetrieveResponse =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(audioAnalysisRetrieveResponse),
                jacksonTypeRef<AudioAnalysisRetrieveResponse>(),
            )

        assertThat(roundtrippedAudioAnalysisRetrieveResponse)
            .isEqualTo(audioAnalysisRetrieveResponse)
    }
}
